---
import doc from "@/../doc.json";
import ReferenceEntry from "@/components/Reference/ReferenceEntry.astro";
import Layout from "@/layouts/Layout.astro";
import { getStaticPathsByLocales } from "@/util/path";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
    const allDoc: any = doc.types;
    const allDocKeys: string[] = Object.keys(doc.types).filter(
        (k) => k !== "KaboomCtx",
    );

    return getStaticPathsByLocales().flatMap((locale) => {
        return allDocKeys.map((key) => {
            return {
                params: { slug: key, ...locale.params },
                props: {
                    type: allDoc[key],
                    name: key,
                    ...locale.props,
                },
            };
        });
    });
}

const { type, t, lang } = Astro.props;
console.log;
---

<Layout
    {t}
    {lang}
    meta={{
        title: "KAPLAY Docs, " + type[0].name,
        description: type[0].name,
        image: type[0].name,
        keywords: "kaplayjs, guides, documentation",
    }}
    sidebarMode="reference"
>
    <div class="w-full p-4">
        {type?.map((reference: any) => <ReferenceEntry data={reference} />)}
    </div>
</Layout>
